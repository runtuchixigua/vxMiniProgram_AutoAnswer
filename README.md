# 简短说明
这个程序效率很低，俺也是看看有没有可行性，挺好玩的就是了
为啥使用这些技术栈呢？
- 影刀捕获不到小程序窗口（这个不知道是不是我影刀不够熟，反正市场没找到和捕获窗口试了一下都不太行）
- MLM是用来分析图片给答案的，当然这里用OCR的内容也可以使用LLM，俺就是想尝尝VL模型的咸淡
- OCR是用来定位答案位置的

# 小程序AI智能答题自动化工具

这是一个基于Python开发的自动化工具，专门用于识别微信小程序中的题目内容，调用AI大模型分析并获取答案，然后自动点击正确选项完成答题。

## 主要功能

- **窗口自动检测**：自动检测屏幕上的微信窗口
- **智能截图**：捕获指定微信窗口的内容并保存
- **OCR文字识别**：使用PaddleOCR识别图片中的文字内容
- **AI答题分析**：调用多模态大模型分析题目并获取答案
- **自动化点击**：智能定位答案位置并执行鼠标点击操作
- **多种匹配策略**：支持完整文本匹配、分词匹配、关键词匹配等多种策略

## 技术栈

- **Python 3.x**
- **macOS原生API**：使用Quartz和AppKit实现窗口捕获
- **OCR引擎**：PaddleOCR（支持中英文混合识别）
- **AI大模型**：通过OpenAI兼容接口调用多模态模型
- **自动化控制**：pyautogui实现鼠标操作
- **图像处理**：Pillow处理图像数据

## 安装要求

### 1. Python环境

确保已安装Python 3.6或更高版本。

### 2. 安装依赖

```bash
pip install pyautogui paddlepaddle paddleocr pillow openai numpy
```

### 3. 配置OpenAI API

在代码中设置您的API密钥和基础URL：

```python
OPENAI_CONFIG = {
    'api_key': '您的API密钥',
    'base_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1',
    'model': 'qwen-turbo-latest',
    'multimodal_model': 'qwen3-vl-plus',
    # 其他配置...
}
```

## 使用方法

1. **准备工作**：
   - 确保微信已打开，并显示小程序答题界面
   - 确保目标窗口在屏幕上可见且未被遮挡

2. **运行程序**：
   ```bash
   python 小程序AI智能答题.py
   ```

3. **程序流程**：
   - 自动检测屏幕上的微信窗口
   - 对每个微信窗口进行截图
   - 调用多模态模型分析截图内容
   - 根据模型返回的答案，在窗口中查找并点击对应的选项

## 核心功能说明

### 1. 窗口检测与截图

程序使用macOS的Quartz框架获取所有可见窗口，并筛选出微信相关窗口。支持多种截图方法确保兼容性。

### 2. OCR文字识别

使用PaddleOCR进行文字识别，支持不同版本的API调用方式，能处理多种格式的返回结果。

### 3. 文本匹配与定位

实现了多种匹配策略：
- 直接文本匹配
- 分词匹配
- 关键词提取与匹配
- 短句分割匹配

### 4. 坐标转换与点击

精确计算OCR识别坐标到屏幕坐标的转换，确保点击位置准确无误。

## 注意事项

1. **权限要求**：
   - 程序需要屏幕录制权限（用于截图）
   - 程序需要辅助功能权限（用于鼠标控制）

2. **安全设置**：
   - pyautogui设置了故障保护，移动鼠标到屏幕左上角可以中断操作
   - 每个操作后有1秒暂停，防止操作过快

3. **API费用**：
   - 调用AI大模型会产生相应的API费用，请合理使用

4. **兼容性**：
   - 目前只支持macOS系统
   - 针对微信小程序答题场景优化，可能需要根据实际界面调整

## 故障排除

1. **无法检测到窗口**：
   - 检查微信是否正在运行
   - 确保窗口可见且未最小化

2. **OCR识别不准确**：
   - 确保截图清晰
   - 可能需要调整PaddleOCR的参数

3. **点击位置偏移**：
   - 程序已优化坐标转换精度，但可能需要根据不同分辨率的屏幕进行微调

4. **权限错误**：
   - 在系统偏好设置中检查并授予相应权限

## 许可证

本项目仅供学习和研究使用。

## 更新日志

### 最新版本
- 优化了坐标转换精度，确保点击位置准确
- 增强了文本匹配策略，提高了匹配成功率
- 添加了详细的调试日志输出

---

*注意：本工具仅用于学习和研究目的，请勿用于任何违反平台规则的行为。*